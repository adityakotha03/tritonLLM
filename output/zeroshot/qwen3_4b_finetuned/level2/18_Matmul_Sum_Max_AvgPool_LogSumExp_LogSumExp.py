import torch
import triton
import triton.language as tl
from torch._inductor.runtime.triton_heuristics import grid
from torch._C import _cuda_getCurrentRawStream as get_raw_stream
from torch._inductor.runtime import triton_helpers
from torch._inductor.runtime.triton_helpers import libdevice, math as tl_math
import torch.nn as nn
assert_size_stride = torch._C._dynamo.guards.assert_size_stride
empty_strided_cuda = torch._C._dynamo.guards._empty_strided_cuda
reinterpret_tensor = torch._C._dynamo.guards._reinterpret_tensor


@triton.jit
def triton_poi_fused_mean_sum_0(in_out_ptr0, in_ptr0, xnumel, XBLOCK: tl.
    constexpr):
    xnumel = 1024
    xoffset = tl.program_id(0) * XBLOCK
    xindex = xoffset + tl.arange(0, XBLOCK)[:]
    xmask = xindex < xnumel
    x2 = xindex
    x0 = xindex % 1024
    tmp0 = tl.load(in_out_ptr0 + x2, xmask)
    tmp1 = tl.load(in_ptr0 + x0, xmask, eviction_policy='evict_last')
    tmp2 = tmp0 + tmp1
    tmp3 = tl.broadcast_to(tmp2, [XBLOCK])
    tmp5 = triton_helpers.promote_to_tensor(tl.sum(tmp3, 0))
    tmp6 = 1024.0
    tmp7 = tmp5 / tmp6
    tl.store(in_out_ptr0 + x2, tmp7, xmask)


@triton.jit
def triton_poi_fused_logsumexp_mean_sum_1(in_ptr0, in_ptr1, in_ptr2,
    out_ptr0, xnumel, XBLOCK: tl.constexpr):
    xnumel = 1024
    xoffset = tl.program_id(0) * XBLOCK
    xindex = xoffset + tl.arange(0, XBLOCK)[:]
    xmask = xindex < xnumel
    x2 = xindex
    x0 = xindex % 1024
    tmp0 = tl.load(in_ptr0 + x2, xmask)
    tmp1 = tl.load(in_ptr1 + x0, xmask, eviction_policy='evict_last')
    tmp3 = tl.load(in_ptr2 + x0, xmask, eviction_policy='evict_last')
    tmp2 = tmp0 + tmp1
    tmp4 = tmp2 + tmp3
    tmp5 = tmp0 + tmp0
    tmp6 = tmp5 + tmp5
    tmp7 = tmp6 + tmp6
    tmp8 = tmp7 + tmp7
    tmp9 = tmp8 + tmp8
    tmp10 = tmp9 + tmp9
    tmp11 = tmp10 + tmp10
    tmp12 = tmp11 + tmp11
    tmp13 = tmp12 + tmp12
    tmp14 = tmp13 + tmp13
    tmp15 = tmp14 + tmp14
    tmp16 = tmp15 + tmp15
    tmp17 = tmp16 + tmp16
    tmp18 = tmp17 + tmp17
    tmp19 = tmp18 + tmp18
    tmp20 = tmp19 + tmp19
    tmp21 = tmp20 + tmp20
    tmp22 = tmp21 + tmp21
    tmp23 = tmp22 + tmp22
    tmp24 = tmp23 + tmp23
    tmp25 = tmp24 + tmp24
    tmp26 = tmp25 + tmp25
    tmp27 = tmp26 + tmp26
    tmp28 = tmp27 + tmp27
    tmp29 = tmp28 + tmp28
    tmp30 = tmp29 + tmp29
    tmp31 = tmp30 + tmp30
    tmp32 = tmp31 + tmp31
    tmp33 = tmp32 + tmp32
    tmp34 = tmp33 + tmp33
    tmp35 = tmp34 + tmp34
    tmp36 = tmp35 + tmp35
    tmp37 = tmp36 + tmp36
    tmp38 = tmp37 + tmp37
    tmp39 = tmp38 + tmp38
    tmp40 = tmp39 + tmp39
    tmp41 = tmp40 + tmp40
    tmp42 = tmp41 + tmp41
    tmp43 = tmp42 + tmp42
    tmp44 = tmp43 + tmp43
    tmp45 = tmp44 + tmp44
    tmp46 = tmp45 + tmp45
    tmp47 = tmp46 + tmp46
    tmp48 = tmp47 + tmp47
    tmp49 = tmp48 + tmp48
    tmp50 = tmp49 + tmp49
    tmp51 = tmp50 + tmp50
    tmp52 = tmp51 + tmp51
    tmp53 = tmp52 + tmp52
    tmp54 = tmp53 + tmp53
    tmp55 = tmp54 + tmp54
    tmp56 = tmp55 + tmp55
    tmp57 = tmp56 + tmp56
    tmp58 = tmp57 + tmp57
    tmp59 = tmp58 + tmp58
    tmp60 = tmp59 + tmp59
    tmp61 = tmp60 + tmp60
    tmp62 = tmp61 + tmp61
    tmp63 = tmp62 + tmp62
    tmp64 = tmp63 + tmp63
    tmp65 = tmp64 + tmp64
    tmp66 = tmp65 + tmp65
    tmp67 = tmp66 + tmp66
    tmp68 = tmp67 + tmp67
    tmp69 = tmp68 + tmp68
    tmp70 = tmp69 + tmp69
    tmp71 = tmp70 + tmp70
    tmp72 = tmp71 + tmp71
    tmp73 = tmp72 + tmp72
    tmp74 = tmp73 + tmp73
    tmp75 = tmp74 + tmp74
    tmp76 = tmp75 + tmp75
    tmp77 = tmp76 + tmp76
    tmp78 = tmp77 + tmp77
    tmp79 = tmp78 + tmp78
    tmp80 = tmp79 + tmp79
    tmp81 = tmp80 + tmp80
    tmp82 = tmp81 + tmp81
    tmp83 = tmp82 + tmp82
    tmp84 = tmp83 + tmp83
    tmp85 = tmp84 + tmp84
    tmp86 = tmp85 + tmp85
    tmp87 = tmp86 + tmp86
    tmp88 = tmp87 + tmp87
    tmp89 = tmp88 + tmp88
    tmp90 = tmp89 + tmp89
    tmp91 = tmp90 + tmp90
    tmp92 = tmp91 + tmp91
    tmp93 = tmp92 + tmp92
    tmp94 = tmp93 + tmp93
    tmp95 = tmp94 + tmp94
    tmp96 = tmp95 + tmp95
    tmp97 = tmp96 + tmp96
    tmp98 = tmp97 + tmp97
    tmp99 = tmp98 + tmp98
    tmp100 = tmp99 + tmp99
    tmp101 = tmp100 + tmp100
    tmp102 = tmp101 + tmp101
    tmp103 = tmp102 + tmp102
    tmp104 = tmp103 + tmp103
    tmp105 = tmp104 + tmp104
    tmp106 = tmp105 + tmp105
    tmp107 = tmp106 + tmp106
    tmp108 = tmp107 + tmp107
    tmp109 = tmp108 + tmp108
    tmp110 = tmp109 + tmp109
    tmp111 = tmp110 + tmp110
    tmp112 = tmp111 + tmp111
    tmp113 = tmp112 + tmp112
    tmp114 = tmp113 + tmp113
    tmp115 = tmp114 + tmp114
    tmp116 = tmp115 + tmp115
    tmp117 = tmp116 + tmp116
    tmp118 = tmp117 + tmp117
    tmp119 = tmp118 + tmp118
    tmp120 = tmp119 + tmp119
    tmp121 = tmp120 + tmp120
    tmp122 = tmp121 + tmp121
    tmp123 = tmp122 + tmp122
    tmp124 = tmp123 + tmp123
    tmp125 = tmp124 + tmp124
    tmp126 = tmp125 + tmp125
    tmp127 = tmp126 + tmp126
    tmp128 = tmp127 + tmp127
    tmp129 = tmp128 + tmp128
    tmp130 = tmp129 + tmp129
    tmp131 = tmp130 + tmp130
    tmp132 = tmp131 + tmp131
    tmp133 = tmp132 + tmp132
    tmp134 = tmp133 + tmp133
    tmp135 = tmp134 + tmp134
    tmp136 = tmp135 + tmp135
    tmp137 = tmp136 + tmp136
    tmp138 = tmp137 + tmp137
    tmp139 = tmp138 + tmp138
    tmp140 = tmp139 + tmp139
    tmp141 = tmp140 + tmp140
    tmp142 = tmp141 + tmp141
    tmp143 = tmp142 + tmp142
    tmp144 = tmp143 + tmp143
    tmp145 = tmp144 + tmp144
    tmp146 = tmp145 + tmp145
    tmp147 = tmp146 + tmp146
    tmp148 = tmp147 + tmp147
    tmp149 = tmp148 + tmp148
    tmp150 = tmp149 + tmp149
    tmp151 = tmp150 + tmp150
    tmp152 = tmp151 + tmp151
    tmp153 = tmp152 + tmp152
    tmp154 = tmp153 + tmp153
    tmp155 = tmp154 + tmp154
    tmp156 = tmp155 + tmp155
    tmp157 = tmp156 + tmp156
    tmp158 = tmp157 + tmp157
    tmp159 = tmp158 + tmp158
    tmp160 = tmp159 + tmp159
    tmp161 = tmp160 + tmp160
    tmp162 = tmp161 + tmp161
    tmp163 = tmp162 + tmp162
    tmp164 = tmp163 + tmp163
    tmp165 = tmp164 + tmp164
    tmp166 = tmp165 + tmp165
    tmp167 = tmp166 + tmp166
    tmp168 = tmp167 + tmp167
    tmp169 = tmp168 + tmp168
    tmp170 = tmp169 + tmp169
    tmp171 = tmp170 + tmp170
    tmp172 = tmp171 + tmp171
    tmp173 = tmp172 + tmp172
    tmp174 = tmp173 + tmp173
    tmp175 = tmp174 + tmp174
    tmp176 = tmp175 + tmp175
    tmp177 = tmp176 + tmp176
    tmp178 = tmp177 + tmp177
    tmp179 = tmp178 + tmp178
    tmp180 = tmp179 + tmp179
    tmp181 = tmp180 + tmp180
    tmp182 = tmp181 + tmp181
    tmp183 = tmp182 + tmp182
    tmp184 = tmp183 + tmp183
    tmp185 = tmp184 + tmp184
    tmp186 = tmp185 + tmp185
    tmp187 = tmp186 + tmp186
    tmp188 = tmp187 + tmp187
    tmp189 = tmp188 + tmp188
    tmp190 = tmp189 + tmp189
    tmp191 = tmp190 + tmp190
    tmp192 = tmp191 + tmp191
    tmp193 = tmp192 + tmp192
    tmp194 = tmp193 + tmp193
    tmp195 = tmp194 + tmp194
    tmp196 = tmp195 + tmp195
    tmp197 = tmp196 + tmp196
    tmp198 = tmp197 + tmp197
    tmp199 = tmp198 + tmp198
    tmp200 = tmp199 + tmp199
    tmp201 = tmp200 + tmp200
    tmp202 = tmp201 + tmp201
    tmp203 = tmp202 + tmp202
    tmp204 = tmp203 + tmp203
    tmp205 = tmp204 + tmp204
    tmp206 = tmp205 + tmp205
    tmp207 = tmp206 + tmp206
    tmp208 = tmp207 + tmp207
    tmp209 = tmp208 + tmp208
    tmp210 = tmp209 + tmp209
    tmp211 = tmp210 + tmp210
    tmp212 = tmp211 + tmp211
    tmp213 = tmp212 + tmp212
    tmp214 = tmp213 + tmp213
    tmp215 = tmp214 + tmp214
    tmp216 = tmp215 + tmp215
    tmp217 = tmp216 + tmp216
    tmp218 = tmp217 + tmp217
    tmp219 = tmp218 + tmp218
    tmp220 = tmp219 + tmp219
    tmp221 = tmp220 + tmp220
    tmp222 = tmp221 + tmp221
    tmp223 = tmp222 + tmp222
    tmp224 = tmp223 + tmp223
    tmp225 = tmp224 + tmp224
    tmp226 = tmp225 + tmp225
    tmp227 = tmp226 + tmp226
    tmp228 = tmp227 + tmp227
    tmp229 = tmp228 + tmp228
    tmp230 = tmp229 + tmp229
    tmp231 = tmp230 + tmp230
    tmp232 = tmp231 + tmp231
    tmp233 = tmp232 + tmp232
    tmp234 = tmp233 + tmp233
    tmp235 = tmp234 + tmp234
    tmp236 = tmp235 + tmp235
    tmp237 = tmp236 + tmp236
    tmp238 = tmp237 + tmp237
    tmp239 = tmp238 + tmp238
    tmp240 = tmp239 + tmp239
    tmp241 = tmp240 + tmp240
    tmp242 = tmp241 + tmp241
    tmp243 = tmp242 + tmp242
    tmp244 = tmp243 + tmp243
    tmp245 = tmp244 + tmp244
    tmp246 = tmp245 + tmp245
    tmp247 = tmp246 + tmp246
    tmp248 = tmp247 + tmp247
    tmp249 = tmp248 + tmp248
    tmp250 = tmp249 + tmp249
    tmp251 = tmp250 + tmp250
    tmp252 = tmp251 + tmp251
    tmp253 = tmp252 + tmp252
    tmp254 = tmp253 + tmp253
    tmp255 = tmp254 + tmp254
    tmp256 = tmp255 + tmp255
    tmp257 = tmp256 + tmp256
    tmp258 = tmp257 + tmp257
    tmp259 = tmp258 + tmp258
    tmp260 = tmp259 + tmp259
    tmp261 = tmp260 + tmp260
    tmp262 = tmp261 + tmp261
    tmp263 = tmp262 + tmp262
    tmp264 = tmp263 + tmp263
    tmp265 = tmp264 + tmp264
    tmp266 = tmp265 + tmp265
    tmp267 = tmp266 + tmp266
    tmp268 = tmp267 + tmp267
    tmp269 = tmp268 + tmp268
    tmp270 = tmp269 + tmp269
    tmp271 = tmp270 + tmp270
    tmp272 = tmp271 + tmp271
    tmp273 = tmp272 + tmp272
    tmp274 = tmp273 + tmp273
    tmp275 = tmp274 + tmp274
    tmp276 = tmp275 + tmp275
    tmp277 = tmp276 + tmp276
    tmp278 = tmp277 + tmp277
    tmp279 = tmp278 + tmp278
    tmp280 = tmp279 + tmp279
    tmp281 = tmp280 + tmp280
    tmp282 = tmp281 + tmp281
    tmp283 = tmp282 + tmp282
    tmp284 = tmp283 + tmp283
    tmp285 = tmp284 + tmp284
    tmp286 = tmp285 + tmp285
    tmp287 = tmp286 + tmp286
    tmp288 = tmp287 + tmp287
    tmp289 = tmp288 + tmp288
    tmp290 = tmp289 + tmp289
    tmp291 = tmp290 + tmp290
    tmp292 = tmp291 + tmp291
    tmp293 = tmp292 + tmp292
    tmp294 = tmp293 + tmp293
    tmp295 = tmp294 + tmp294
    tmp296 = tmp295 + tmp295
    tmp297 = tmp296 + tmp296
    tmp298 = tmp297 + tmp297
    tmp299 = tmp298 + tmp298
    tmp300 = tmp299 + tmp299
    tmp301 = tmp300 + tmp300
    tmp302 = tmp301 + tmp301
    tmp303 = tmp302 + tmp302
    tmp304 = tmp303 + tmp303
    tmp305 = tmp304 + tmp304
    tmp306 = tmp305 + tmp305
    tmp307 = tmp306 + tmp306
    tmp308 = tmp307 + tmp307
    tmp309 = tmp308 + tmp308
    tmp310 = tmp309 + tmp309
    tmp311 = tmp310 + tmp310
    tmp312 = tmp311 + tmp311
    tmp313 = tmp312 + tmp312
    tmp314 = tmp313 + tmp313
    tmp315 = tmp314 + tmp314
    tmp316 = tmp315 + tmp315
    tmp317 = tmp316 + tmp316
    tmp318 = tmp317 + tmp317
    tmp319 = tmp318 + tmp318
    tmp320 = tmp319 + tmp319
    tmp321 = tmp320 + tmp320
    tmp322 = tmp321 + tmp321
    tmp323 = tmp322 + tmp322
    tmp324 = tmp323 + tmp323
    tmp325 = tmp324 + tmp324
    tmp326 = tmp325 + tmp325
    tmp327 = tmp326 + tmp326
    tmp328 = tmp327 + tmp327
    tmp329 = tmp328 + tmp328
    tmp330 = tmp329 + tmp329
    tmp331 = tmp330 + tmp330
    tmp332 = tmp331 + tmp331
    tmp333 = tmp332 + tmp332
    tmp334 = tmp333 + tmp333
    tmp335 = tmp334 + tmp334
    tmp336 = tmp335 + tmp335
    tmp337 = tmp336 + tmp336
    tmp338 = tmp337 + tmp337
    tmp339 = tmp338 + tmp338
    tmp340 = tmp339 + tmp339
    tmp341 = tmp340 + tmp340
    tmp342 = tmp341 + tmp341
    tmp343 = tmp342 + tmp342
    tmp344 = tmp343 + tmp343
    tmp345 = tmp344 + tmp344
    tmp346 = tmp345 + tmp345
    tmp347 = tmp346 + tmp346
    tmp348 = tmp347 + tmp347
    tmp349 = tmp348 + tmp348
    tmp350 = tmp349 + tmp349
    tmp351 = tmp350 + tmp350
    tmp352 = tmp351 + tmp351
    tmp353 = tmp352 + tmp352
    tmp354 = tmp353 + tmp353
    tmp355 = tmp354 + tmp354
    tmp356 = tmp355 + tmp355
    tmp357 = tmp356 + tmp356
    tmp358 = tmp357 + tmp357
    tmp359 = tmp358 + tmp358
    tmp360 = tmp359 + tmp359
    tmp361 = tmp360 + tmp360
    tmp362 = tmp361 + tmp361
    tmp363 = tmp362 + tmp362
    tmp364 = tmp363 + tmp363
    tmp365 = tmp364 + tmp364
    tmp366 = tmp365 + tmp365
    tmp367 = tmp366 + tmp366
    tmp368 = tmp367 + tmp367
    tmp369 = tmp368 + tmp368
    tmp370 = tmp369 + tmp369
    tmp371 = tmp370 + tmp370
    tmp372 = tmp371 + tmp371
    tmp373 = tmp372 + tmp372
    tmp374 = tmp373 + tmp373
    tmp375 = tmp374 + tmp374
    tmp376 = tmp375 + tmp375
    tmp377 = tmp376 + tmp376
    tmp378 = tmp377 + tmp377
    tmp379 = tmp378 + tmp378
    tmp380 = tmp379 + tmp379
    tmp381 = tmp380 + tmp380
    tmp382 = tmp381 + tmp381
    tmp383 = tmp382 + tmp382
    tmp384 = tmp383 + tmp383
    tmp385 = tmp384 + tmp384
    tmp386 = tmp385 + tmp385
    tmp387 = tmp386 + tmp386
    tmp388 = tmp387 + tmp387
    tmp389 = tmp388 + tmp388
    tmp390 = tmp389 + tmp389
    tmp391 = tmp390 + tmp390
    tmp392 = tmp391 + tmp391
    tmp393 = tmp392 + tmp392
    tmp394 = tmp393 + tmp393
    tmp395 = tmp394 + tmp394
    tmp396 = tmp395 + tmp395
    tmp397 = tmp396 + tmp396
    tmp398 = tmp397 + tmp397
    tmp399 = tmp398 + tmp398
    tmp400 = tmp399 + tmp399
    tmp401 = tmp400 + tmp400
    tmp402 = tmp401 + tmp401
    tmp403 = tmp402 + tmp402
    tmp404 = tmp403 + tmp403
    tmp405 = tmp404 + tmp404
    tmp406 = tmp405 + tmp405
    tmp407 = tmp406 + tmp406
    tmp408 = tmp407 + tmp407
    tmp409 = tmp408 + tmp408
    tmp410 = tmp409 + tmp409
    tmp411 = tmp410 + tmp410
    tmp412 = tmp411 + tmp411
    tmp413 = tmp412 + tmp412
    tmp414 = tmp413 + tmp413
    tmp415 = tmp414 + tmp414
    tmp416 = tmp415 + tmp415
    tmp417 = tmp416 + tmp416
    tmp418 = tmp417 + tmp417
    tmp419 = tmp418 + tmp418
    tmp420 = tmp419 + tmp419
    tmp421 = tmp420 + tmp420
    tmp422 = tmp421 + tmp421
    tmp423 = tmp422 + tmp422
    tmp424 = tmp423 + tmp423
    tmp425 = tmp424 + tmp424
    tmp426 = tmp425 + tmp425
    tmp427 = tmp426 + tmp426
    tmp428 = tmp427 + tmp427
    tmp429 = tmp428 + tmp428
    tmp430 = tmp429 + tmp429
    tmp431 = tmp430 + tmp430
    tmp432 = tmp431 + tmp431
    tmp433 = tmp432 + tmp432
    tmp434 = tmp433 + tmp433
    tmp435 = tmp434 + tmp434
    tmp436 = tmp435 + tmp435
    tmp437 = tmp436 + tmp436
    tmp438 = tmp437 + tmp437
    tmp439 = tmp438 + tmp438
    tmp440 = tmp439 + tmp439
    tmp441 = tmp440 + tmp440
    tmp442 = tmp441 + tmp441
    tmp443 = tmp442 + tmp442
    tmp444 = tmp443 + tmp443
    tmp445 = tmp444 + tmp444
    tmp446 = tmp445 + tmp445
    tmp447 = tmp446 + tmp446
    tmp448 = tmp447 + tmp447
    tmp449 = tmp448 + tmp448
    tmp450 = tmp449 + tmp449
    tmp451 = tmp450 + tmp450
    tmp452 = tmp451 + tmp451
    tmp453 = tmp452 + tmp452
    tmp454 = tmp453 + tmp453
    tmp455 = tmp454 + tmp454
    tmp456 = tmp455 + tmp455
    tmp457 = tmp456 + tmp456
    tmp458 = tmp457 + tmp457
    tmp459 = tmp458 + tmp458
    tmp460 = tmp459 + tmp459
    tmp461 = tmp460 + tmp460
    tmp462 = tmp461 + tmp461
    tmp463 = tmp462 + tmp462
    tmp464 = tmp463 + tmp463
    tmp465 = tmp464 + tmp464
    tmp466 = tmp465 + tmp465
    tmp467 = tmp466 + tmp466
    tmp468 = tmp467 + tmp467
    tmp469 = tmp468 + tmp468
    tmp470 = tmp469 + tmp469
    tmp471 = tmp470 + tmp470
    tmp472 = tmp471 + tmp471
    tmp473 = tmp472 + tmp472
    tmp474 = tmp473 + tmp473
    tmp475 = tmp474 + tmp474
    tmp476 = tmp475 + tmp475
    tmp477 = tmp476 + tmp476
    tmp478 = tmp477 + tmp477
    tmp479 = tmp478 + tmp478
    tmp480 = tmp479 + tmp479
    tmp481 = tmp480 + tmp480
    tmp482 = tmp481 + tmp481
    tmp483 = tmp482 + tmp482
    tmp484 = tmp483 + tmp483
    tmp485 = tmp484 + tmp484
    tmp486 = tmp485 + tmp485
    tmp487 = tmp486 + tmp486
    tmp488 = tmp487 + tmp487
    tmp489 = tmp488 + tmp488
    tmp490 = tmp489 + tmp489
    tmp491 = tmp490 + tmp490
    tmp492 = tmp491 + tmp491
    tmp493 = tmp492 + tmp492
    tmp494 = tmp493 + tmp493
    tmp495 = tmp494 + tmp494
    tmp496 = tmp495 + tmp495
    tmp497 = tmp496 + tmp496
    tmp498 = tmp497 + tmp497
    tmp499 = tmp498 + tmp498
    tmp500 = tmp49