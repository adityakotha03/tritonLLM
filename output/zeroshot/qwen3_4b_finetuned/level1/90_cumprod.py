import torch
import triton
import triton.language as tl
from torch._inductor.runtime.triton_heuristics import grid
from torch._C import _cuda_getCurrentRawStream as get_raw_stream
from torch._inductor.runtime import triton_helpers
import torch.nn as nn
assert_size_stride = torch._C._dynamo.guards.assert_size_stride
empty_strided_cuda = torch._C._dynamo.guards._empty_strided_cuda


@triton.jit
def triton_per_fused_cumprod_0(in_ptr0, out_ptr0, xnumel, rnumel, XBLOCK:
    tl.constexpr):
    xnumel = 32768
    RBLOCK: tl.constexpr = 65536
    xoffset = tl.program_id(0) * XBLOCK
    xindex = xoffset + tl.arange(0, XBLOCK)[:, None]
    xmask = xindex < xnumel
    rindex = tl.arange(0, RBLOCK)[None, :]
    tl.full([XBLOCK, RBLOCK], True, tl.int1)
    r2 = rindex
    x0 = xindex
    tmp0 = tl.load(in_ptr0 + x0, xmask, eviction_policy='evict_last')
    tmp1 = tl.load(in_ptr0 + (r2 + 65536 * x0), xmask, other=1.0)
    tmp3 = tl.load(in_ptr0 + (1 + r2 + 65536 * x0), xmask, other=1.0)
    tmp5 = tl.load(in_ptr0 + (2 + r2 + 65536 * x0), xmask, other=1.0)
    tmp7 = tl.load(in_ptr0 + (3 + r2 + 65536 * x0), xmask, other=1.0)
    tmp10 = tl.load(in_ptr0 + (4 + r2 + 65536 * x0), xmask, other=1.0)
    tmp13 = tl.load(in_ptr0 + (5 + r2 + 65536 * x0), xmask, other=1.0)
    tmp16 = tl.load(in_ptr0 + (6 + r2 + 65536 * x0), xmask, other=1.0)
    tmp19 = tl.load(in_ptr0 + (7 + r2 + 65536 * x0), xmask, other=1.0)
    tmp22 = tl.load(in_ptr0 + (8 + r2 + 65536 * x0), xmask, other=1.0)
    tmp25 = tl.load(in_ptr0 + (9 + r2 + 65536 * x0), xmask, other=1.0)
    tmp28 = tl.load(in_ptr0 + (10 + r2 + 65536 * x0), xmask, other=1.0)
    tmp31 = tl.load(in_ptr0 + (11 + r2 + 65536 * x0), xmask, other=1.0)
    tmp34 = tl.load(in_ptr0 + (12 + r2 + 65536 * x0), xmask, other=1.0)
    tmp37 = tl.load(in_ptr0 + (13 + r2 + 65536 * x0), xmask, other=1.0)
    tmp40 = tl.load(in_ptr0 + (14 + r2 + 65536 * x0), xmask, other=1.0)
    tmp43 = tl.load(in_ptr0 + (15 + r2 + 65536 * x0), xmask, other=1.0)
    tmp46 = tl.load(in_ptr0 + (16 + r2 + 65536 * x0), xmask, other=1.0)
    tmp49 = tl.load(in_ptr0 + (17 + r2 + 65536 * x0), xmask, other=1.0)
    tmp52 = tl.load(in_ptr0 + (18 + r2 + 65536 * x0), xmask, other=1.0)
    tmp55 = tl.load(in_ptr0 + (19 + r2 + 65536 * x0), xmask, other=1.0)
    tmp58 = tl.load(in_ptr0 + (20 + r2 + 65536 * x0), xmask, other=1.0)
    tmp61 = tl.load(in_ptr0 + (21 + r2 + 65536 * x0), xmask, other=1.0)
    tmp64 = tl.load(in_ptr0 + (22 + r2 + 65536 * x0), xmask, other=1.0)
    tmp67 = tl.load(in_ptr0 + (23 + r2 + 65536 * x0), xmask, other=1.0)
    tmp70 = tl.load(in_ptr0 + (24 + r2 + 65536 * x0), xmask, other=1.0)
    tmp73 = tl.load(in_ptr0 + (25 + r2 + 65536 * x0), xmask, other=1.0)
    tmp76 = tl.load(in_ptr0 + (26 + r2 + 65536 * x0), xmask, other=1.0)
    tmp79 = tl.load(in_ptr0 + (27 + r2 + 65536 * x0), xmask, other=1.0)
    tmp82 = tl.load(in_ptr0 + (28 + r2 + 65536 * x0), xmask, other=1.0)
    tmp85 = tl.load(in_ptr0 + (29 + r2 + 65536 * x0), xmask, other=1.0)
    tmp88 = tl.load(in_ptr0 + (30 + r2 + 65536 * x0), xmask, other=1.0)
    tmp91 = tl.load(in_ptr0 + (31 + r2 + 65536 * x0), xmask, other=1.0)
    tmp94 = tl.load(in_ptr0 + (32 + r2 + 65536 * x0), xmask, other=1.0)
    tmp97 = tl.load(in_ptr0 + (33 + r2 + 65536 * x0), xmask, other=1.0)
    tmp100 = tl.load(in_ptr0 + (34 + r2 + 65536 * x0), xmask, other=1.0)
    tmp103 = tl.load(in_ptr0 + (35 + r2 + 65536 * x0), xmask, other=1.0)
    tmp106 = tl.load(in_ptr0 + (36 + r2 + 65536 * x0), xmask, other=1.0)
    tmp109 = tl.load(in_ptr0 + (37 + r2 + 65536 * x0), xmask, other=1.0)
    tmp112 = tl.load(in_ptr0 + (38 + r2 + 65536 * x0), xmask, other=1.0)
    tmp115 = tl.load(in_ptr0 + (39 + r2 + 65536 * x0), xmask, other=1.0)
    tmp118 = tl.load(in_ptr0 + (40 + r2 + 65536 * x0), xmask, other=1.0)
    tmp121 = tl.load(in_ptr0 + (41 + r2 + 65536 * x0), xmask, other=1.0)
    tmp124 = tl.load(in_ptr0 + (42 + r2 + 65536 * x0), xmask, other=1.0)
    tmp127 = tl.load(in_ptr0 + (43 + r2 + 65536 * x0), xmask, other=1.0)
    tmp130 = tl.load(in_ptr0 + (44 + r2 + 65536 * x0), xmask, other=1.0)
    tmp133 = tl.load(in_ptr0 + (45 + r2 + 65536 * x0), xmask, other=1.0)
    tmp136 = tl.load(in_ptr0 + (46 + r2 + 65536 * x0), xmask, other=1.0)
    tmp139 = tl.load(in_ptr0 + (47 + r2 + 65536 * x0), xmask, other=1.0)
    tmp142 = tl.load(in_ptr0 + (48 + r2 + 65536 * x0), xmask, other=1.0)
    tmp145 = tl.load(in_ptr0 + (49 + r2 + 65536 * x0), xmask, other=1.0)
    tmp148 = tl.load(in_ptr0 + (50 + r2 + 65536 * x0), xmask, other=1.0)
    tmp151 = tl.load(in_ptr0 + (51 + r2 + 65536 * x0), xmask, other=1.0)
    tmp154 = tl.load(in_ptr0 + (52 + r2 + 65536 * x0), xmask, other=1.0)
    tmp157 = tl.load(in_ptr0 + (53 + r2 + 65536 * x0), xmask, other=1.0)
    tmp160 = tl.load(in_ptr0 + (54 + r2 + 65536 * x0), xmask, other=1.0)
    tmp163 = tl.load(in_ptr0 + (55 + r2 + 65536 * x0), xmask, other=1.0)
    tmp166 = tl.load(in_ptr0 + (56 + r2 + 65536 * x0), xmask, other=1.0)
    tmp169 = tl.load(in_ptr0 + (57 + r2 + 65536 * x0), xmask, other=1.0)
    tmp172 = tl.load(in_ptr0 + (58 + r2 + 65536 * x0), xmask, other=1.0)
    tmp175 = tl.load(in_ptr0 + (59 + r2 + 65536 * x0), xmask, other=1.0)
    tmp178 = tl.load(in_ptr0 + (60 + r2 + 65536 * x0), xmask, other=1.0)
    tmp181 = tl.load(in_ptr0 + (61 + r2 + 65536 * x0), xmask, other=1.0)
    tmp184 = tl.load(in_ptr0 + (62 + r2 + 65536 * x0), xmask, other=1.0)
    tmp187 = tl.load(in_ptr0 + (63 + r2 + 65536 * x0), xmask, other=1.0)
    tmp190 = tl.load(in_ptr0 + (64 + r2 + 65536 * x0), xmask, other=1.0)
    tmp193 = tl.load(in_ptr0 + (65 + r2 + 65536 * x0), xmask, other=1.0)
    tmp196 = tl.load(in_ptr0 + (66 + r2 + 65536 * x0), xmask, other=1.0)
    tmp199 = tl.load(in_ptr0 + (67 + r2 + 65536 * x0), xmask, other=1.0)
    tmp202 = tl.load(in_ptr0 + (68 + r2 + 65536 * x0), xmask, other=1.0)
    tmp205 = tl.load(in_ptr0 + (69 + r2 + 65536 * x0), xmask, other=1.0)
    tmp208 = tl.load(in_ptr0 + (70 + r2 + 65536 * x0), xmask, other=1.0)
    tmp211 = tl.load(in_ptr0 + (71 + r2 + 65536 * x0), xmask, other=1.0)
    tmp214 = tl.load(in_ptr0 + (72 + r2 + 65536 * x0), xmask, other=1.0)
    tmp217 = tl.load(in_ptr0 + (73 + r2 + 65536 * x0), xmask, other=1.0)
    tmp220 = tl.load(in_ptr0 + (74 + r2 + 65536 * x0), xmask, other=1.0)
    tmp223 = tl.load(in_ptr0 + (75 + r2 + 65536 * x0), xmask, other=1.0)
    tmp226 = tl.load(in_ptr0 + (76 + r2 + 65536 * x0), xmask, other=1.0)
    tmp229 = tl.load(in_ptr0 + (77 + r2 + 65536 * x0), xmask, other=1.0)
    tmp232 = tl.load(in_ptr0 + (78 + r2 + 65536 * x0), xmask, other=1.0)
    tmp235 = tl.load(in_ptr0 + (79 + r2 + 65536 * x0), xmask, other=1.0)
    tmp238 = tl.load(in_ptr0 + (80 + r2 + 65536 * x0), xmask, other=1.0)
    tmp241 = tl.load(in_ptr0 + (81 + r2 + 65536 * x0), xmask, other=1.0)
    tmp244 = tl.load(in_ptr0 + (82 + r2 + 65536 * x0), xmask, other=1.0)
    tmp247 = tl.load(in_ptr0 + (83 + r2 + 65536 * x0), xmask, other=1.0)
    tmp250 = tl.load(in_ptr0 + (84 + r2 + 65536 * x0), xmask, other=1.0)
    tmp253 = tl.load(in_ptr0 + (85 + r2 + 65536 * x0), xmask, other=1.0)
    tmp256 = tl.load(in_ptr0 + (86 + r2 + 65536 * x0), xmask, other=1.0)
    tmp259 = tl.load(in_ptr0 + (87 + r2 + 65536 * x0), xmask, other=1.0)
    tmp262 = tl.load(in_ptr0 + (88 + r2 + 65536 * x0), xmask, other=1.0)
    tmp265 = tl.load(in_ptr0 + (89 + r2 + 65536 * x0), xmask, other=1.0)
    tmp268 = tl.load(in_ptr0 + (90 + r2 + 65536 * x0), xmask, other=1.0)
    tmp271 = tl.load(in_ptr0 + (91 + r2 + 65536 * x0), xmask, other=1.0)
    tmp274 = tl.load(in_ptr0 + (92 + r2 + 65536 * x0), xmask, other=1.0)
    tmp277 = tl.load(in_ptr0 + (93 + r2 + 65536 * x0), xmask, other=1.0)
    tmp280 = tl.load(in_ptr0 + (94 + r2 + 65536 * x0), xmask, other=1.0)
    tmp283 = tl.load(in_ptr0 + (95 + r2 + 65536 * x0), xmask, other=1.0)
    tmp286 = tl.load(in_ptr0 + (96 + r2 + 65536 * x0), xmask, other=1.0)
    tmp289 = tl.load(in_ptr0 + (97 + r2 + 65536 * x0), xmask, other=1.0)
    tmp292 = tl.load(in_ptr0 + (98 + r2 + 65536 * x0), xmask, other=1.0)
    tmp295 = tl.load(in_ptr0 + (99 + r2 + 65536 * x0), xmask, other=1.0)
    tmp298 = tl.load(in_ptr0 + (100 + r2 + 65536 * x0), xmask, other=1.0)
    tmp301 = tl.load(in_ptr0 + (101 + r2 + 65536 * x0), xmask, other=1.0)
    tmp304 = tl.load(in_ptr0 + (102 + r2 + 65536 * x0), xmask, other=1.0)
    tmp307 = tl.load(in_ptr0 + (103 + r2 + 65536 * x0), xmask, other=1.0)
    tmp310 = tl.load(in_ptr0 + (104 + r2 + 65536 * x0), xmask, other=1.0)
    tmp313 = tl.load(in_ptr0 + (105 + r2 + 65536 * x0), xmask, other=1.0)
    tmp316 = tl.load(in_ptr0 + (106 + r2 + 65536 * x0), xmask, other=1.0)
    tmp319 = tl.load(in_ptr0 + (107 + r2 + 65536 * x0), xmask, other=1.0)
    tmp322 = tl.load(in_ptr0 + (108 + r2 + 65536 * x0), xmask, other=1.0)
    tmp325 = tl.load(in_ptr0 + (109 + r2 + 65536 * x0), xmask, other=1.0)
    tmp328 = tl.load(in_ptr0 + (110 + r2 + 65536 * x0), xmask, other=1.0)
    tmp331 = tl.load(in_ptr0 + (111 + r2 + 65536 * x0), xmask, other=1.0)
    tmp334 = tl.load(in_ptr0 + (112 + r2 + 65536 * x0), xmask, other=1.0)
    tmp337 = tl.load(in_ptr0 + (113 + r2 + 65536 * x0), xmask, other=1.0)
    tmp340 = tl.load(in_ptr0 + (114 + r2 + 65536 * x0), xmask, other=1.0)
    tmp343 = tl.load(in_ptr0 + (115 + r2 + 65536 * x0), xmask, other=1.0)
    tmp346 = tl.load(in_ptr0 + (116 + r2 + 65536 * x0), xmask, other=1.0)
    tmp349 = tl.load(in_ptr0 + (117 + r2 + 65536 * x0), xmask, other=1.0)
    tmp352 = tl.load(in_ptr0 + (118 + r2 + 65536 * x0), xmask, other=1.0)
    tmp355 = tl.load(in_ptr0 + (119 + r2 + 65536 * x0), xmask, other=1.0)
    tmp358 = tl.load(in_ptr0 + (120 + r2 + 65536 * x0), xmask, other=1.0)
    tmp361 = tl.load(in_ptr0 + (121 + r2 + 65536 * x0), xmask, other=1.0)
    tmp364 = tl.load(in_ptr0 + (122 + r2 + 65536 * x0), xmask, other=1.0)
    tmp367 = tl.load(in_ptr0 + (123 + r2 + 65536 * x0), xmask, other=1.0)
    tmp370 = tl.load(in_ptr0 + (124 + r2 + 65536 * x0), xmask, other=1.0)
    tmp373 = tl.load(in_ptr0 + (125 + r2 + 65536 * x0), xmask, other=1.0)
    tmp376 = tl.load(in_ptr0 + (126 + r2 + 65536 * x0), xmask, other=1.0)
    tmp379 = tl.load(in_ptr0 + (127 + r2 + 65536 * x0), xmask, other=1.0)
    tmp382 = tl.load(in_ptr0 + (128 + r2 + 65536 * x0), xmask, other=1.0)
    tmp385 = tl.load(in_ptr0 + (129 + r2 + 65536 * x0), xmask, other=1.0)
    tmp388 = tl.load(in_ptr0 + (130 + r2 + 65536 * x0), xmask, other=1.0)
    tmp391 = tl.load(in_ptr0 + (131 + r2 + 65536 * x0), xmask, other=1.0)
    tmp394 = tl.load(in_ptr0 + (132 + r2 + 65536 * x0), xmask, other=1.0)
    tmp397 = tl.load(in_ptr0 + (133 + r2 + 65536 * x0), xmask, other=1.0)
    tmp400 = tl.load(in_ptr0 + (134 + r2 + 65536 * x0), xmask, other=1.0)
    tmp403 = tl.load(in_ptr0 + (135 + r2 + 65536 * x0), xmask, other=1.0)
    tmp406 = tl.load(in_ptr0 + (136 + r2 + 65536 * x0), xmask, other=1.0)
    tmp409 = tl.load(in_ptr0 + (137 + r2 + 65536 * x0), xmask, other=1.0)
    tmp412 = tl.load(in_ptr0 + (138 + r2 + 65536 * x0), xmask, other=1.0)
    tmp415 = tl.load(in_ptr0 + (139 + r2 + 65536 * x0), xmask, other=1.0)
    tmp418 = tl.load(in_ptr0 + (140 + r2 + 65536 * x0), xmask, other=1.0)
    tmp421 = tl.load(in_ptr0 + (141 + r2 + 65536 * x0), xmask, other=1.0)
    tmp424 = tl.load(in_ptr0 + (142 + r2 + 65536 * x0), xmask, other=1.0)
    tmp427 = tl.load(in_ptr0 + (143 + r2 + 65536 * x0), xmask, other=1.0)
    tmp430 = tl.load(in_ptr0 + (144 + r2 + 65536 * x0), xmask, other=1.0)
    tmp433 = tl.load(in_ptr0 + (145 + r2 + 65536 * x0), xmask, other=1.0)
    tmp436 = tl.load(in_ptr0 + (146 + r2 + 65536 * x0), xmask, other=1.0)
    tmp439 = tl.load(in_ptr0 + (147 + r2 + 65536 * x0), xmask, other=1.0)
    tmp442 = tl.load(in_ptr0 + (148 + r2 + 65536 * x0), xmask, other=1.0)
    tmp445 = tl.load(in_ptr0 + (149 + r2 + 65536 * x0), xmask, other=1.0)
    tmp448 = tl.load(in_ptr0 + (150 + r2 + 65536 * x0), xmask, other=1.0)
    tmp451 = tl.load(in_ptr0 + (151 + r2 + 65536 * x0), xmask, other=1.0)
    tmp454 = tl.load(in_ptr0 + (152 + r2 + 65536 * x0), xmask, other=1.0)
    tmp457 = tl.load(in_ptr0 + (153 + r2 + 65536 * x0), xmask, other=1.0)
    tmp460 = tl.load(in_ptr0 + (154 + r2 + 65536 * x0), xmask, other=1.0)
    tmp463 = tl.load(in_ptr0 + (155 + r2 + 65536 * x0), xmask, other=1.0)
    tmp466 = tl.load(in_ptr0 + (156 + r2 + 65536 * x0), xmask, other=1.0)
    tmp469 = tl.load(in_ptr0 + (157 + r2 + 65536 * x0), xmask, other=1.0)
    tmp472 = tl.load(in_ptr0 + (158 + r2 + 65536 * x0), xmask, other=1.0)
    tmp475 = tl.load(in_ptr0 + (159 + r2 + 65536 * x0), xmask, other=1.0)
    tmp478 = tl.load(in_ptr0 + (160 + r2 + 65536 * x0), xmask, other=1.0)
    tmp481 = tl.load(in_ptr0 + (161 + r2 + 65536 * x0), xmask, other=1.0)
    tmp484 = tl.load(in_ptr0 + (162 + r2 + 65536 * x0), xmask, other=1.0)
    tmp487 = tl.load(in_ptr0 + (163 + r2 + 65536 * x0), xmask, other=1.0)
    tmp490 = tl.load(in_ptr0 + (164 + r2 + 65536 * x0), xmask, other=1.0)
    tmp493 = tl.load(in_ptr0 + (165 + r2 + 65536 * x0), xmask, other=1.0)
    tmp496 = tl.load(in_ptr0 + (166 + r2 + 65536 * x0), xmask, other=1.0)
    tmp499 = tl.load(in_ptr0 + (167 + r2 + 65536 * x0), xmask, other=1.0)
    tmp502 = tl.load(in_ptr0 + (168 + r2 + 65536 * x0), xmask, other=1.0)
    tmp505 = tl.load(in_ptr0 + (169 + r2 + 65536 * x0), xmask, other=1.0)
    tmp508 = tl.load(in_ptr0 + (170 + r2 + 65536 * x0), xmask, other=1.0)
    tmp511 = tl.load(in_ptr0 + (171 + r2 + 65536 * x0), xmask, other=1.0)
    tmp514 = tl.load(in_ptr0 + (172 + r2 + 65536 * x0), xmask, other=1.0)
    tmp517 = tl.load(in_ptr0 + (173 + r2 + 65536 * x0), xmask, other=1.0)
    tmp520 = tl.load(in_ptr0 + (174 + r2 + 65536 * x0), xmask, other=1.0)
    tmp523 = tl.load(in_ptr0 + (175 + r2 + 65536 * x0), xmask, other=1.0)
    tmp526 = tl.load(in_ptr0 + (176 + r2 + 65536 * x0), xmask, other=1.0)
    tmp529 = tl.load(in_ptr0 + (177 + r2 + 65536 * x0), xmask, other=1.0)
    tmp532 = tl.load(in_ptr0 + (178 + r2 + 65536 * x0), xmask, other=1.0)
    tmp535 = tl.load(in_ptr0 + (179 + r2 + 65536 * x0), xmask, other=1.0)
    tmp538 = tl.load(in_ptr0 + (180 + r2 + 65536 * x0), xmask, other=1.0)
    tmp541 = tl.load(in_ptr0 + (181 + r2 + 65536 * x0), xmask, other=1.0)
    tmp544 = tl.load(in_ptr0 + (182 + r2 + 65536 * x0), xmask, other=1.0)
    tmp547 = tl.load(in_ptr0 + (183 + r2 + 65536 * x0), xmask, other=1.0)
    tmp550 = tl.load(in_ptr0 + (184 + r2 + 65536 * x0), xmask, other=1.0)
    tmp553 = tl.load(in_ptr0 + (185 + r2 + 65536 * x0), xmask, other=1.0)
    tmp556 = tl.load(in_ptr0 + (186 + r2 + 65536 * x0), xmask, other=1.0)
    tmp559 = tl.load(in_ptr0 + (187 + r2 + 65536 * x0), xmask, other=1.0)
    tmp562 = tl.load(in_ptr0 + (188 + r2 + 65536 * x0), xmask, other=1.0)
    tmp565 = tl.load(in_ptr0 + (189 + r2 + 65536 * x0), xmask, other=1.0)
    tmp568 = tl.load(in_ptr0 + (190 + r2 + 65536 * x0), xmask, other=1.0)
    tmp571 = tl.load(in_ptr0 + (191 + r2 + 65536 * x0), xmask, other=1.0)
    tmp574 = tl.load(in_ptr0 + (192 + r2 + 65536 * x0), xmask, other=1.0)
    tmp577 = tl.load(in_ptr0 + (193 + r2 + 65536 * x0), xmask, other=1.0)
    tmp580 = tl.load(in_ptr0 + (194 + r2 + 65536 * x0), xmask, other=1.0)
    tmp583 = tl.load(in_ptr0 + (195 + r2 + 65536 * x0), xmask, other=1.0)
    tmp586 = tl.load(in_ptr0 + (196 + r2 + 65536 * x0), xmask, other=1.0)
    tmp589 = tl.load(in_ptr0 + (197 + r2 + 65536 * x0), xmask, other=1.0)
    tmp592 = tl.load(in_ptr0 + (198 + r2 + 65536 * x0), xmask, other=1.0)
    tmp595 = tl.load(in_ptr0 + (199 + r2 + 65536 * x0), xmask, other=1.0)
    tmp598 = tl.load(in_ptr0 + (200 + r2 + 65536 * x0), xmask, other=1.0)
    tmp601 = tl.load(in_ptr0 + (201 + r2 + 65536 * x0), xmask, other=1.0)
    tmp604 = tl.load(in_ptr0 + (202 + r2 + 65536 * x0), xmask, other=1.0)
    tmp607 = tl.load(in_ptr0 + (203 + r2 + 65536 * x0), xmask, other=1.0)
    tmp610 = tl.load(in_ptr0 + (204 + r2 + 65536 * x0), xmask, other=1.0)
    tmp613 = tl.load(in_ptr0 + (205 + r2 + 65536 * x0), xmask, other=1.0)
    tmp616 = tl.load(in_ptr0 + (206 + r2 + 65536 * x0), x