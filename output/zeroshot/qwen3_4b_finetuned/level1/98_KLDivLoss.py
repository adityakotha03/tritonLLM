import torch
import triton
import triton.language as tl
from torch._inductor.runtime.triton_heuristics import grid
from torch._C import _cuda_getCurrentRawStream as get_raw_stream
from torch._inductor.runtime.triton_helpers import libdevice
import torch.nn as nn
assert_size_stride = torch._C._dynamo.guards.assert_size_stride
empty_strided_cuda = torch._C._dynamo.guards._empty_strided_cuda


@triton.jit
def triton_poi_fused__softmax_0(in_ptr0, out_ptr0, xnumel, XBLOCK: tl.constexpr
    ):
    xnumel = 16384
    xoffset = tl.program_id(0) * XBLOCK
    xindex = xoffset + tl.arange(0, XBLOCK)[:]
    xmask = xindex < xnumel
    x0 = xindex
    tmp0 = tl.load(in_ptr0 + x0, xmask)
    tmp1 = libdevice.expm1(tmp0)
    tmp2 = libdevice.log1p(tmp1)
    tmp3 = tl.broadcast_to(tmp2, [XBLOCK])
    tl.store(out_ptr0 + x0, tmp3, xmask)


@triton.jit
def triton_poi_fused__softmax_1(in_ptr0, out_ptr0, xnumel, XBLOCK: tl.constexpr
    ):
    xnumel = 16384
    xoffset = tl.program_id(0) * XBLOCK
    xindex = xoffset + tl.arange(0, XBLOCK)[:]
    xmask = xindex < xnumel
    x2 = xindex
    x0 = xindex % 2048
    tmp0 = tl.load(in_ptr0 + x2, xmask)
    tmp1 = tl.load(in_ptr0 + (x0 + 2048 * 16384), xmask, eviction_policy=
        'evict_last')
    tmp2 = tl.load(in_ptr0 + (2048 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp4 = tl.load(in_ptr0 + (4096 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp6 = tl.load(in_ptr0 + (6144 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp9 = tl.load(in_ptr0 + (8192 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp11 = tl.load(in_ptr0 + (10240 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp13 = tl.load(in_ptr0 + (12288 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp15 = tl.load(in_ptr0 + (14336 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp17 = tl.load(in_ptr0 + (16384 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp19 = tl.load(in_ptr0 + (18432 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp21 = tl.load(in_ptr0 + (20480 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp23 = tl.load(in_ptr0 + (22528 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp25 = tl.load(in_ptr0 + (24576 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp27 = tl.load(in_ptr0 + (26624 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp29 = tl.load(in_ptr0 + (28672 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp31 = tl.load(in_ptr0 + (30720 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp33 = tl.load(in_ptr0 + (32768 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp35 = tl.load(in_ptr0 + (34816 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp37 = tl.load(in_ptr0 + (36864 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp39 = tl.load(in_ptr0 + (38912 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp41 = tl.load(in_ptr0 + (40960 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp43 = tl.load(in_ptr0 + (43008 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp45 = tl.load(in_ptr0 + (45056 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp47 = tl.load(in_ptr0 + (47104 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp49 = tl.load(in_ptr0 + (49152 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp51 = tl.load(in_ptr0 + (51200 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp53 = tl.load(in_ptr0 + (53248 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp55 = tl.load(in_ptr0 + (55296 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp57 = tl.load(in_ptr0 + (57344 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp59 = tl.load(in_ptr0 + (59392 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp61 = tl.load(in_ptr0 + (61440 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp63 = tl.load(in_ptr0 + (63488 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp65 = tl.load(in_ptr0 + (65536 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp67 = tl.load(in_ptr0 + (67584 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp69 = tl.load(in_ptr0 + (69632 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp71 = tl.load(in_ptr0 + (71680 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp73 = tl.load(in_ptr0 + (73728 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp75 = tl.load(in_ptr0 + (75776 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp77 = tl.load(in_ptr0 + (77824 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp79 = tl.load(in_ptr0 + (79872 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp81 = tl.load(in_ptr0 + (81920 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp83 = tl.load(in_ptr0 + (83968 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp85 = tl.load(in_ptr0 + (86016 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp87 = tl.load(in_ptr0 + (88064 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp89 = tl.load(in_ptr0 + (90112 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp91 = tl.load(in_ptr0 + (92160 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp93 = tl.load(in_ptr0 + (94208 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp95 = tl.load(in_ptr0 + (96256 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp97 = tl.load(in_ptr0 + (98304 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp99 = tl.load(in_ptr0 + (100352 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp101 = tl.load(in_ptr0 + (102400 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp103 = tl.load(in_ptr0 + (104448 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp105 = tl.load(in_ptr0 + (106496 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp107 = tl.load(in_ptr0 + (108544 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp109 = tl.load(in_ptr0 + (110592 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp111 = tl.load(in_ptr0 + (112640 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp113 = tl.load(in_ptr0 + (114688 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp115 = tl.load(in_ptr0 + (116736 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp117 = tl.load(in_ptr0 + (118784 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp119 = tl.load(in_ptr0 + (120832 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp121 = tl.load(in_ptr0 + (122880 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp123 = tl.load(in_ptr0 + (124928 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp125 = tl.load(in_ptr0 + (126976 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp127 = tl.load(in_ptr0 + (129024 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp129 = tl.load(in_ptr0 + (131072 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp131 = tl.load(in_ptr0 + (133120 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp133 = tl.load(in_ptr0 + (135168 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp135 = tl.load(in_ptr0 + (137216 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp137 = tl.load(in_ptr0 + (139264 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp139 = tl.load(in_ptr0 + (141312 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp141 = tl.load(in_ptr0 + (143360 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp143 = tl.load(in_ptr0 + (145408 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp145 = tl.load(in_ptr0 + (147456 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp147 = tl.load(in_ptr0 + (149504 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp149 = tl.load(in_ptr0 + (151552 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp151 = tl.load(in_ptr0 + (153600 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp153 = tl.load(in_ptr0 + (155648 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp155 = tl.load(in_ptr0 + (157696 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp157 = tl.load(in_ptr0 + (159744 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp159 = tl.load(in_ptr0 + (161792 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp161 = tl.load(in_ptr0 + (163840 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp163 = tl.load(in_ptr0 + (165888 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp165 = tl.load(in_ptr0 + (167936 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp167 = tl.load(in_ptr0 + (170084 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp169 = tl.load(in_ptr0 + (172132 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp171 = tl.load(in_ptr0 + (174180 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp173 = tl.load(in_ptr0 + (176228 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp175 = tl.load(in_ptr0 + (178276 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp177 = tl.load(in_ptr0 + (180324 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp179 = tl.load(in_ptr0 + (182372 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp181 = tl.load(in_ptr0 + (184420 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp183 = tl.load(in_ptr0 + (186468 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp185 = tl.load(in_ptr0 + (188516 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp187 = tl.load(in_ptr0 + (190564 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp189 = tl.load(in_ptr0 + (192612 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp191 = tl.load(in_ptr0 + (194660 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp193 = tl.load(in_ptr0 + (196708 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp195 = tl.load(in_ptr0 + (198756 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp197 = tl.load(in_ptr0 + (200804 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp199 = tl.load(in_ptr0 + (202852 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp201 = tl.load(in_ptr0 + (204900 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp203 = tl.load(in_ptr0 + (206948 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp205 = tl.load(in_ptr0 + (208996 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp207 = tl.load(in_ptr0 + (211044 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp209 = tl.load(in_ptr0 + (213092 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp211 = tl.load(in_ptr0 + (215140 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp213 = tl.load(in_ptr0 + (217188 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp215 = tl.load(in_ptr0 + (219236 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp217 = tl.load(in_ptr0 + (221284 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp219 = tl.load(in_ptr0 + (223332 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp221 = tl.load(in_ptr0 + (225380 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp223 = tl.load(in_ptr0 + (227428 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp225 = tl.load(in_ptr0 + (229476 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp227 = tl.load(in_ptr0 + (231524 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp229 = tl.load(in_ptr0 + (233572 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp231 = tl.load(in_ptr0 + (235620 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp233 = tl.load(in_ptr0 + (237668 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp235 = tl.load(in_ptr0 + (239716 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp237 = tl.load(in_ptr0 + (241764 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp239 = tl.load(in_ptr0 + (243812 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp241 = tl.load(in_ptr0 + (245860 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp243 = tl.load(in_ptr0 + (247908 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp245 = tl.load(in_ptr0 + (249956 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp247 = tl.load(in_ptr0 + (252004 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp249 = tl.load(in_ptr0 + (254052 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp251 = tl.load(in_ptr0 + (256100 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp253 = tl.load(in_ptr0 + (258148 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp255 = tl.load(in_ptr0 + (260196 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp257 = tl.load(in_ptr0 + (262244 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp259 = tl.load(in_ptr0 + (264292 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp261 = tl.load(in_ptr0 + (266340 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp263 = tl.load(in_ptr0 + (268388 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp265 = tl.load(in_ptr0 + (270436 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp267 = tl.load(in_ptr0 + (272484 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp269 = tl.load(in_ptr0 + (274532 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp271 = tl.load(in_ptr0 + (276580 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp273 = tl.load(in_ptr0 + (278628 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp275 = tl.load(in_ptr0 + (280676 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp277 = tl.load(in_ptr0 + (282724 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp279 = tl.load(in_ptr0 + (284772 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp281 = tl.load(in_ptr0 + (286820 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp283 = tl.load(in_ptr0 + (288868 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp285 = tl.load(in_ptr0 + (290916 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp287 = tl.load(in_ptr0 + (292964 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp289 = tl.load(in_ptr0 + (295012 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp291 = tl.load(in_ptr0 + (297060 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp293 = tl.load(in_ptr0 + (299108 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp295 = tl.load(in_ptr0 + (301156 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp297 = tl.load(in_ptr0 + (303204 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp299 = tl.load(in_ptr0 + (305252 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp301 = tl.load(in_ptr0 + (307300 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp303 = tl.load(in_ptr0 + (309348 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp305 = tl.load(in_ptr0 + (311396 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp307 = tl.load(in_ptr0 + (313444 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp309 = tl.load(in_ptr0 + (315492 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp311 = tl.load(in_ptr0 + (317540 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp313 = tl.load(in_ptr0 + (319588 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp315 = tl.load(in_ptr0 + (321636 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp317 = tl.load(in_ptr0 + (323684 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp319 = tl.load(in_ptr0 + (325732 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp321 = tl.load(in_ptr0 + (327780 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp323 = tl.load(in_ptr0 + (329828 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp325 = tl.load(in_ptr0 + (331876 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp327 = tl.load(in_ptr0 + (333924 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp329 = tl.load(in_ptr0 + (335972 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp331 = tl.load(in_ptr0 + (338020 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp333 = tl.load(in_ptr0 + (340068 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp335 = tl.load(in_ptr0 + (342116 + x0 + 2048 * 16384), xmask,
        eviction_policy='evict_last')
    tmp337 = tl.load(in_ptr0 + (