import torch
from torch._inductor.select_algorithm import extern_kernels
import triton
import triton.language as tl
from torch._inductor.runtime.triton_heuristics import grid
from torch._C import _cuda_getCurrentRawStream as get_raw_stream
from torch._inductor.runtime import triton_helpers
import torch.nn as nn
assert_size_stride = torch._C._dynamo.guards.assert_size_stride
empty_strided_cuda = torch._C._dynamo.guards._empty_strided_cuda
reinterpret_tensor = torch._C._dynamo.guards._reinterpret_tensor


@triton.jit
def triton_per_fused_lstm_0(in_out_ptr0, in_ptr0, in_ptr1, in_ptr2,
    in_ptr3, out_ptr0, out_ptr1, xnumel, rnumel, XBLOCK: tl.constexpr):
    xnumel = 128
    RBLOCK: tl.constexpr = 128
    xoffset = tl.program_id(0) * XBLOCK
    xindex = xoffset + tl.arange(0, XBLOCK)[:, None]
    xmask = xindex < xnumel
    rindex = tl.arange(0, RBLOCK)[None, :]
    tl.full([XBLOCK, RBLOCK], True, tl.int1)
    r1 = rindex
    x0 = xindex
    tmp0 = tl.load(in_out_ptr0 + x0, xmask, eviction_policy='evict_last')
    tmp5 = tl.load(in_ptr0 + 0)
    tmp6 = tl.broadcast_to(tmp5, [XBLOCK, RBLOCK])
    tmp11 = tl.load(in_ptr1 + 0)
    tmp12 = tl.broadcast_to(tmp11, [XBLOCK, RBLOCK])
    tmp17 = tl.load(in_ptr2 + r1, None)
    tmp18 = tl.load(in_ptr3 + r1, None)
    tmp21 = tl.load(in_ptr2 + (128 + r1), None)
    tmp22 = tl.load(in_ptr3 + (128 + r1), None)
    tmp25 = tl.load(in_ptr2 + (256 + r1), None)
    tmp26 = tl.load(in_ptr3 + (256 + r1), None)
    tmp31 = tl.load(in_ptr2 + (384 + r1), None)
    tmp32 = tl.load(in_ptr3 + (384 + r1), None)
    tmp37 = tl.load(in_ptr2 + (512 + r1), None)
    tmp38 = tl.load(in_ptr3 + (512 + r1), None)
    tmp43 = tl.load(in_ptr2 + (640 + r1), None)
    tmp44 = tl.load(in_ptr3 + (640 + r1), None)
    tmp49 = tl.load(in_ptr2 + (768 + r1), None)
    tmp50 = tl.load(in_ptr3 + (768 + r1), None)
    tmp55 = tl.load(in_ptr2 + (896 + r1), None)
    tmp56 = tl.load(in_ptr3 + (896 + r1), None)
    tmp61 = tl.load(in_ptr2 + (1024 + r1), None)
    tmp62 = tl.load(in_ptr3 + (1024 + r1), None)
    tmp67 = tl.load(in_ptr2 + (1152 + r1), None)
    tmp68 = tl.load(in_ptr3 + (1152 + r1), None)
    tmp0 = tmp0 + tmp6
    tmp1 = tmp0.to(tl.float32)
    tmp2 = tmp1 * tmp12
    tmp3 = tl.sigmoid(tmp2)
    tmp4 = tmp1 + (-tmp3)
    tmp5 = tl.broadcast_to(tmp4, [XBLOCK, RBLOCK])
    tmp7 = tmp0 * tmp12
    tmp8 = tmp7.to(tl.float32)
    tmp9 = tl.sigmoid(tmp8)
    tmp10 = tmp7 + (-tmp9)
    tmp13 = tmp3 * tmp18
    tmp14 = tmp13 + tmp10
    tmp15 = tmp12 * tmp14
    tmp16 = tmp15.to(tl.float32)
    tmp17 = tmp16 + tmp17
    tmp19 = tmp3 * tmp22
    tmp20 = tmp19 + tmp10
    tmp23 = tmp16 * tmp21
    tmp24 = tmp23 + tmp20
    tmp25 = tmp25 * tmp16
    tmp26 = tmp26 + tmp25
    tmp27 = tmp24 * tmp22
    tmp28 = tmp27 + tmp26
    tmp29 = tmp28 * tmp14
    tmp30 = tmp29 + tmp24
    tmp31 = tmp30 * tmp16
    tmp32 = tmp32 + tmp31
    tmp33 = tmp31 * tmp12
    tmp34 = tmp33 + tmp32
    tmp35 = tmp30 * tmp14
    tmp36 = tmp35 + tmp34
    tmp37 = tmp36 * tmp16
    tmp38 = tmp38 + tmp37
    tmp39 = tmp37 * tmp12
    tmp40 = tmp39 + tmp38
    tmp41 = tmp36 * tmp14
    tmp42 = tmp41 + tmp40
    tmp43 = tmp42 * tmp16
    tmp44 = tmp44 + tmp43
    tmp45 = tmp43 * tmp12
    tmp46 = tmp45 + tmp44
    tmp47 = tmp42 * tmp14
    tmp48 = tmp47 + tmp46
    tmp49 = tmp48 * tmp16
    tmp50 = tmp50 + tmp49
    tmp51 = tmp49 * tmp12
    tmp52 = tmp51 + tmp50
    tmp53 = tmp48 * tmp14
    tmp54 = tmp53 + tmp52
    tmp55 = tmp54 * tmp16
    tmp56 = tmp56 + tmp55
    tmp57 = tmp55 * tmp12
    tmp58 = tmp57 + tmp56
    tmp59 = tmp54 * tmp14
    tmp60 = tmp59 + tmp58
    tmp61 = tmp61 * tmp16
    tmp62 = tmp62 + tmp61
    tmp63 = tmp61 * tmp12
    tmp64 = tmp63 + tmp62
    tmp65 = tmp60 * tmp14
    tmp66 = tmp65 + tmp64
    tmp67 = tmp67 * tmp16
    tmp68 = tmp68 + tmp67
    tmp69 = tmp67 * tmp12
    tmp70 = tmp69 + tmp68
    tmp71 = tmp66 * tmp14
    tmp72 = tmp71 + tmp70
    tmp73 = tmp72 * tmp16
    tmp74 = tmp73 + tmp67
    tmp75 = tmp73 * tmp12
    tmp76 = tmp75 + tmp74
    tmp77 = tmp72 * tmp14
    tmp78 = tmp77 + tmp76
    tmp79 = tmp78 * tmp16
    tmp80 = tmp79 + tmp73
    tmp81 = tmp79 * tmp12
    tmp82 = tmp81 + tmp80
    tmp83 = tmp78 * tmp14
    tmp84 = tmp83 + tmp82
    tmp85 = tmp84 * tmp16
    tmp86 = tmp85 + tmp79
    tmp87 = tmp85 * tmp12
    tmp88 = tmp87 + tmp86
    tmp89 = tmp84 * tmp14
    tmp90 = tmp89 + tmp88
    tmp91 = tmp90 * tmp16
    tmp92 = tmp91 + tmp85
    tmp93 = tmp91 * tmp12
    tmp94 = tmp93 + tmp92
    tmp95 = tmp90 * tmp14
    tmp96 = tmp95 + tmp94
    tmp97 = tmp96 * tmp16
    tmp98 = tmp97 + tmp91
    tmp99 = tmp97 * tmp12
    tmp100 = tmp99 + tmp98
    tmp101 = tmp96 * tmp14
    tmp102 = tmp101 + tmp100
    tmp103 = tmp102 * tmp16
    tmp104 = tmp103 + tmp97
    tmp105 = tmp103 * tmp12
    tmp106 = tmp105 + tmp104
    tmp107 = tmp102 * tmp14
    tmp108 = tmp107 + tmp106
    tmp109 = tmp108 * tmp16
    tmp110 = tmp109 + tmp103
    tmp111 = tmp109 * tmp12
    tmp112 = tmp111 + tmp110
    tmp113 = tmp108 * tmp14
    tmp114 = tmp113 + tmp112
    tmp115 = tmp114 * tmp16
    tmp116 = tmp115 + tmp109
    tmp117 = tmp115 * tmp12
    tmp118 = tmp117 + tmp116
    tmp119 = tmp114 * tmp14
    tmp120 = tmp119 + tmp118
    tmp121 = tmp120 * tmp16
    tmp122 = tmp121 + tmp115
    tmp123 = tmp121 * tmp12
    tmp124 = tmp123 + tmp122
    tmp125 = tmp120 * tmp14
    tmp126 = tmp125 + tmp124
    tmp127 = tmp126 * tmp16
    tmp128 = tmp127 + tmp121
    tmp129 = tmp127 * tmp12
    tmp130 = tmp129 + tmp128
    tmp131 = tmp126 * tmp14
    tmp132 = tmp131 + tmp130
    tmp133 = tmp132 * tmp16
    tmp134 = tmp133 + tmp127
    tmp135 = tmp133 * tmp12
    tmp136 = tmp135 + tmp134
    tmp137 = tmp132 * tmp14
    tmp138 = tmp137 + tmp136
    tmp139 = tmp138 * tmp16
    tmp140 = tmp139 + tmp133
    tmp141 = tmp139 * tmp12
    tmp142 = tmp141 + tmp140
    tmp143 = tmp138 * tmp14
    tmp144 = tmp143 + tmp142
    tmp145 = tmp144 * tmp16
    tmp146 = tmp145 + tmp139
    tmp147 = tmp145 * tmp12
    tmp148 = tmp147 + tmp146
    tmp149 = tmp144 * tmp14
    tmp150 = tmp149 + tmp148
    tmp151 = tmp150 * tmp16
    tmp152 = tmp151 + tmp145
    tmp153 = tmp151 * tmp12
    tmp154 = tmp153 + tmp152
    tmp155 = tmp150 * tmp14
    tmp156 = tmp155 + tmp154
    tmp157 = tmp156 * tmp16
    tmp158 = tmp157 + tmp151
    tmp159 = tmp157 * tmp12
    tmp160 = tmp159 + tmp158
    tmp161 = tmp156 * tmp14
    tmp162 = tmp161 + tmp160
    tmp163 = tmp162 * tmp16
    tmp164 = tmp163 + tmp157
    tmp165 = tmp163 * tmp12
    tmp166 = tmp165 + tmp164
    tmp167 = tmp162 * tmp14
    tmp168 = tmp167 + tmp166
    tmp169 = tmp168 * tmp16
    tmp170 = tmp169 + tmp163
    tmp171 = tmp169 * tmp12
    tmp172 = tmp171 + tmp170
    tmp173 = tmp168 * tmp14
    tmp174 = tmp173 + tmp172
    tmp175 = tmp174 * tmp16
    tmp176 = tmp175 + tmp169
    tmp177 = tmp175 * tmp12
    tmp178 = tmp177 + tmp176
    tmp179 = tmp174 * tmp14
    tmp180 = tmp179 + tmp178
    tmp181 = tmp180 * tmp16
    tmp182 = tmp181 + tmp175
    tmp183 = tmp181 * tmp12
    tmp184 = tmp183 + tmp182
    tmp185 = tmp180 * tmp14
    tmp186 = tmp185 + tmp184
    tmp187 = tmp186 * tmp16
    tmp188 = tmp187 + tmp181
    tmp189 = tmp187 * tmp12
    tmp190 = tmp189 + tmp188
    tmp191 = tmp186 * tmp14
    tmp192 = tmp191 + tmp190
    tmp193 = tmp192 * tmp16
    tmp194 = tmp193 + tmp187
    tmp195 = tmp193 * tmp12
    tmp196 = tmp195 + tmp194
    tmp197 = tmp192 * tmp14
    tmp198 = tmp197 + tmp196
    tmp199 = tmp198 * tmp16
    tmp200 = tmp199 + tmp193
    tmp201 = tmp199 * tmp12
    tmp202 = tmp201 + tmp200
    tmp203 = tmp198 * tmp14
    tmp204 = tmp203 + tmp202
    tmp205 = tmp204 * tmp16
    tmp206 = tmp205 + tmp199
    tmp207 = tmp205 * tmp12
    tmp208 = tmp207 + tmp206
    tmp209 = tmp204 * tmp14
    tmp210 = tmp209 + tmp208
    tmp211 = tmp210 * tmp16
    tmp212 = tmp211 + tmp205
    tmp213 = tmp211 * tmp12
    tmp214 = tmp213 + tmp212
    tmp215 = tmp210 * tmp14
    tmp216 = tmp215 + tmp214
    tmp217 = tmp216 * tmp16
    tmp218 = tmp217 + tmp211
    tmp219 = tmp217 * tmp12
    tmp220 = tmp219 + tmp218
    tmp221 = tmp216 * tmp14
    tmp222 = tmp221 + tmp220
    tmp223 = tmp222 * tmp16
    tmp224 = tmp223 + tmp217
    tmp225 = tmp223 * tmp12
    tmp226 = tmp225 + tmp224
    tmp227 = tmp222 * tmp14
    tmp228 = tmp227 + tmp226
    tmp229 = tmp228 * tmp16
    tmp230 = tmp229 + tmp223
    tmp231 = tmp229 * tmp12
    tmp232 = tmp231 + tmp230
    tmp233 = tmp228 * tmp14
    tmp234 = tmp233 + tmp232
    tmp235 = tmp234 * tmp16
    tmp236 = tmp235 + tmp229
    tmp237 = tmp235 * tmp12
    tmp238 = tmp237 + tmp236
    tmp239 = tmp234 * tmp14
    tmp240 = tmp239 + tmp238
    tmp241 = tmp240 * tmp16
    tmp242 = tmp241 + tmp235
    tmp243 = tmp241 * tmp12
    tmp244 = tmp243 + tmp242
    tmp245 = tmp240 * tmp14
    tmp246 = tmp245 + tmp244
    tmp247 = tmp246 * tmp16
    tmp248 = tmp247 + tmp241
    tmp249 = tmp247 * tmp12
    tmp250 = tmp249 + tmp248
    tmp251 = tmp246 * tmp14
    tmp252 = tmp251 + tmp250
    tmp253 = tmp252 * tmp16
    tmp254 = tmp253 + tmp247
    tmp255 = tmp253 * tmp12
    tmp256 = tmp255 + tmp254
    tmp257 = tmp252 * tmp14
    tmp258 = tmp257 + tmp256
    tmp259 = tmp258 * tmp16
    tmp260 = tmp259 + tmp253
    tmp261 = tmp259 * tmp12
    tmp262 = tmp261 + tmp260
    tmp263 = tmp258 * tmp14
    tmp264 = tmp263 + tmp262
    tmp265 = tmp264 * tmp16
    tmp266 = tmp265 + tmp259
    tmp267 = tmp265 * tmp12
    tmp268 = tmp267 + tmp266
    tmp269 = tmp264 * tmp14
    tmp270 = tmp269 + tmp268
    tmp271 = tmp270 * tmp16
    tmp272 = tmp271 + tmp265
    tmp273 = tmp271 * tmp12
    tmp274 = tmp273 + tmp272
    tmp275 = tmp270 * tmp14
    tmp276 = tmp275 + tmp274
    tmp277 = tmp276 * tmp16
    tmp278 = tmp277 + tmp271
    tmp279 = tmp277 * tmp12
    tmp280 = tmp279 + tmp278
    tmp281 = tmp276 * tmp14
    tmp282 = tmp281 + tmp280
    tmp283 = tmp282 * tmp16
    tmp284 = tmp283 + tmp277
    tmp285 = tmp283 * tmp12
    tmp286 = tmp285 + tmp284
    tmp287 = tmp282 * tmp14
    tmp288 = tmp287 + tmp286
    tmp289 = tmp288 * tmp16
    tmp290 = tmp289 + tmp283
    tmp291 = tmp289 * tmp12
    tmp292 = tmp291 + tmp290
    tmp293 = tmp288 * tmp14
    tmp294 = tmp293 + tmp292
    tmp295 = tmp294 * tmp16
    tmp296 = tmp295 + tmp289
    tmp297 = tmp295 * tmp12
    tmp298 = tmp297 + tmp296
    tmp299 = tmp294 * tmp14
    tmp300 = tmp299 + tmp298
    tmp301 = tmp300 * tmp16
    tmp302 = tmp301 + tmp295
    tmp303 = tmp301 * tmp12
    tmp304 = tmp303 + tmp302
    tmp305 = tmp300 * tmp14
    tmp306 = tmp305 + tmp304
    tmp307 = tmp306 * tmp16
    tmp308 = tmp307 + tmp301
    tmp309 = tmp307 * tmp12
    tmp310 = tmp309 + tmp308
    tmp311 = tmp306 * tmp14
    tmp312 = tmp311 + tmp310
    tmp313 = tmp312 * tmp16
    tmp314 = tmp313 + tmp307
    tmp315 = tmp313 * tmp12
    tmp316 = tmp315 + tmp314
    tmp317 = tmp312 * tmp14
    tmp318 = tmp317 + tmp316
    tmp319 = tmp318 * tmp16
    tmp320 = tmp319 + tmp313
    tmp321 = tmp319 * tmp12
    tmp322 = tmp321 + tmp320
    tmp323 = tmp318 * tmp14
    tmp324 = tmp323 + tmp322
    tmp325 = tmp324 * tmp16
    tmp326 = tmp325 + tmp319
    tmp327 = tmp325 * tmp12
    tmp328 = tmp327 + tmp326
    tmp329 = tmp324 * tmp14
    tmp330 = tmp329 + tmp328
    tmp331 = tmp330 * tmp16
    tmp332 = tmp331 + tmp325
    tmp333 = tmp331 * tmp12
    tmp334 = tmp333 + tmp332
    tmp335 = tmp330 * tmp14
    tmp336 = tmp335 + tmp334
    tmp337 = tmp336 * tmp16
    tmp338 = tmp337 + tmp331
    tmp339 = tmp337 * tmp12
    tmp340 = tmp339 + tmp338
    tmp341 = tmp336 * tmp14
    tmp342 = tmp341 + tmp340
    tmp343 = tmp342 * tmp16
    tmp344 = tmp343 + tmp337
    tmp345 = tmp343 * tmp12
    tmp346 = tmp345 + tmp344
    tmp347 = tmp342 * tmp14
    tmp348 = tmp347 + tmp346
    tmp349 = tmp348 * tmp16
    tmp350 = tmp349 + tmp343
    tmp351 = tmp349 * tmp12
    tmp352 = tmp351 + tmp350
    tmp353 = tmp348 * tmp14
    tmp354 = tmp353 + tmp352
    tmp355 = tmp354 * tmp16
    tmp356 = tmp355 + tmp349
    tmp357 = tmp355 * tmp12
    tmp358 = tmp357 + tmp356
    tmp359 = tmp354 * tmp14
    tmp360 = tmp359 + tmp358
    tmp361 = tmp360 * tmp16
    tmp362 = tmp361 + tmp355
    tmp363 = tmp361 * tmp12
    tmp364 = tmp363 + tmp362
    tmp365 = tmp360 * tmp14
    tmp366 = tmp365 + tmp364
    tmp367 = tmp366 * tmp16
    tmp368 = tmp367 + tmp361
    tmp369 = tmp367 * tmp12
    tmp370 = tmp369 + tmp368
    tmp371 = tmp366 * tmp14
    tmp372 = tmp371 + tmp370
    tmp373 = tmp372 * tmp16
    tmp374 = tmp373 + tmp367
    tmp375 = tmp373 * tmp12
    tmp376 = tmp375 + tmp374
    tmp377 = tmp372 * tmp14
    tmp378 = tmp377 + tmp376
    tmp379 = tmp378 * tmp16
    tmp380 = tmp379 + tmp373
    tmp381 = tmp379 * tmp12
    tmp382 = tmp381 + tmp380
    tmp383 = tmp378 * tmp14
    tmp384 = tmp383 + tmp382
    tmp385 = tmp384 * tmp16
    tmp386 = tmp385 + tmp379
    tmp387 = tmp385 * tmp12
    tmp388 = tmp387 + tmp386
    tmp389 = tmp384 * tmp14
    tmp390 = tmp389 + tmp388
    tmp391 = tmp390 * tmp16
    tmp392 = tmp391 + tmp385
    tmp393 = tmp391 * tmp12
    tmp394 = tmp393 + tmp392
    tmp395 = tmp390 * tmp14
    tmp396 = tmp395 + tmp394
    tmp397 = tmp396 * tmp16
    tmp398 = tmp397 + tmp391
    tmp399 = tmp397 * tmp12
    tmp400 = tmp399 + tmp398
    tmp401 = tmp396 * tmp14
    tmp402 = tmp401 + tmp400
    tmp403 = tmp402 * tmp16
    tmp404 = tmp403 + tmp397
    tmp405 = tmp403 * tmp12
    tmp406 = tmp405 + tmp404
    tmp407 = tmp402 * tmp14
    tmp408 = tmp407 + tmp406
    tmp409 = tmp408 * tmp16
    tmp410 = tmp409 + tmp403
    tmp411 = tmp409 * tmp12
    tmp412 = tmp411 + tmp410
    tmp413 = tmp408 * tmp14
    tmp414 = tmp413 + tmp412
    tmp415 = tmp414 * tmp16
    tmp416 = tmp415 + tmp409
    tmp417 = tmp415 * tmp12
    tmp418 = tmp417 + tmp416
    tmp419 = tmp414 * tmp14
    tmp420 = tmp419 + tmp418
    tmp421 = tmp420 * tmp16
    tmp422 = tmp421 + tmp415
    tmp423 = tmp421 * tmp12
    tmp424 = tmp423 + tmp422
    tmp425 = tmp420 * tmp14
    tmp426 = tmp425 + tmp424
    tmp427 = tmp426 * tmp16
    tmp428 = tmp427 + tmp421
    tmp429 = tmp427 * tmp12
    tmp430 = tmp429 + tmp428
    tmp431 = tmp426 * tmp14
    tmp432 = tmp431 + tmp430
    tmp433 = tmp432 * tmp16
    tmp434 = tmp433 + tmp427
    tmp435 = tmp433 * tmp12
    tmp436 = tmp435 + tmp434
    tmp437 = tmp432 * tmp14
    tmp438 = tmp437 + tmp436
    tmp439 = tmp438 * tmp16
    tmp440 = tmp439 + tmp433
    tmp441 = tmp439 * tmp12
    tmp442 = tmp441 + tmp440
    tmp443 = tmp438 * tmp14
    tmp444 = tmp443 + tmp442
    tmp445 = tmp444 * tmp16
    tmp446 = tmp445 + tmp439
    tmp447 = tmp445 * tmp12
    tmp448 = tmp447 + tmp446
    tmp449 = tmp444 * tmp14
    tmp450 = tmp449 + tmp448
    tmp451 = tmp450 * tmp16
    tmp452 = tmp451 + tmp445
    tmp453 = tmp451 * tmp12
    tmp454 = tmp453 + tmp452
    tmp455 = tmp450 * tmp14
    tmp456 = tmp455 + tmp454
    tmp457 = tmp456 * tmp16
    tmp458 = tmp457 + tmp451
    tmp459 = tmp457 * tmp12
    tmp460 = tmp459 + tmp458
    tmp461 = tmp456 * tmp14
    tmp462 = tmp461 + tmp460
    tmp463 = tmp462 * tmp16
    tmp464 = tmp463 + tmp457
    tmp465 = tmp463 * tmp12
    tmp466 = tmp465 + tmp464
    tmp467 = tmp462 * tmp14
    tmp468 = tmp467 + tmp466
    tmp469 = tmp468 * tmp16
    tmp470 = tmp469 + tmp463
    tmp471 = tmp469 * tmp12
    tmp472 = tmp471 + tmp470
    tmp473 = tmp468 * tmp14
    tmp474 = tmp473 + tmp472
    tmp475 = tmp474 * tmp16
    tmp476 = tmp475 + tmp469
    tmp477 = tmp475 * tmp12
    tmp478 = tmp477 + tmp476
    tmp479 = tmp474 * tmp14
    tmp480 = tmp479 + tmp478
    tmp481 = tmp480 * tmp16
    tmp482 = tmp481 + tmp475
    tmp483 = tmp481 * tmp12
    tmp484 = tmp483 + tmp482
    tmp485 = tmp480 * tmp14
    tmp486 = tmp485 + tmp484
    tmp487 = tmp486 * tmp16
    tmp488 = tmp487 + tmp481
    tmp489 = tmp487 * tmp12
    tmp490 = tmp489 + tmp488
    tmp491 = tmp486 * tmp14
    tmp492 = tmp491 + tmp490
    tmp493 = tmp492 * tmp16
    tmp494 = tmp493 + tmp487
    tmp495 = tmp493 * tmp12
    tmp496 = tmp495 + tmp494
    tmp497 = tmp492 * tmp14
    tmp498 = tmp497 + tmp496
    tmp49